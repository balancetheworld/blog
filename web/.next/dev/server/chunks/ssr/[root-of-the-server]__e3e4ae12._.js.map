{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/zyj/%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%A4%B9/%E6%88%91%E7%9A%84%E4%BB%A3%E7%A0%81/blog/my-blog/web/lib/api.ts"],"sourcesContent":["// 在服务器端使用绝对 URL，客户端使用相对 URL\nconst getBaseUrl = () => {\n  if (typeof window !== 'undefined') {\n    // 客户端：使用相对路径，通过 Next.js rewrites\n    return ''\n  }\n  // 服务器端：直接使用后端 URL\n  return process.env.BACKEND_URL || 'http://localhost:3001'\n}\n\nasync function fetchAPI(endpoint: string, options?: RequestInit) {\n  const API_BASE_URL = getBaseUrl()\n  const url = `${API_BASE_URL}${endpoint}`\n\n  // Debug logging\n  console.log('[API] Fetching:', url, '(server-side:', typeof window === 'undefined', ')')\n\n  const response = await fetch(url, {\n    ...options,\n    headers: {\n      'Content-Type': 'application/json',\n      ...options?.headers,\n    },\n  })\n\n  console.log('[API] Response status:', response.status, 'OK:', response.ok)\n\n  if (!response.ok) {\n    const errorText = await response.text()\n    console.error('[API] Error response:', errorText)\n    throw new Error(errorText || 'API request failed')\n  }\n\n  const data = await response.json()\n  console.log('[API] Response data:', Array.isArray(data) ? `${data.length} items` : 'data received')\n  return data\n}\n\nexport const api = {\n  get: <T>(endpoint: string, options?: RequestInit) => fetchAPI<T>(endpoint, options),\n  post: <T>(endpoint: string, data: any, options?: RequestInit) => fetchAPI<T>(endpoint, {\n    ...options,\n    method: 'POST',\n    body: JSON.stringify(data),\n  }),\n  put: <T>(endpoint: string, data: any, options?: RequestInit) => fetchAPI<T>(endpoint, {\n    ...options,\n    method: 'PUT',\n    body: JSON.stringify(data),\n  }),\n  delete: <T>(endpoint: string, options?: RequestInit) => fetchAPI<T>(endpoint, {\n    ...options,\n    method: 'DELETE',\n  }),\n}\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;AAC5B,MAAM,aAAa;IACjB;;IAIA,kBAAkB;IAClB,OAAO,QAAQ,GAAG,CAAC,WAAW,IAAI;AACpC;AAEA,eAAe,SAAS,QAAgB,EAAE,OAAqB;IAC7D,MAAM,eAAe;IACrB,MAAM,MAAM,GAAG,eAAe,UAAU;IAExC,gBAAgB;IAChB,QAAQ,GAAG,CAAC,mBAAmB,KAAK,iBAAiB,kDAAkB,aAAa;IAEpF,MAAM,WAAW,MAAM,MAAM,KAAK;QAChC,GAAG,OAAO;QACV,SAAS;YACP,gBAAgB;YAChB,GAAG,SAAS,OAAO;QACrB;IACF;IAEA,QAAQ,GAAG,CAAC,0BAA0B,SAAS,MAAM,EAAE,OAAO,SAAS,EAAE;IAEzE,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,YAAY,MAAM,SAAS,IAAI;QACrC,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM,IAAI,MAAM,aAAa;IAC/B;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,QAAQ,GAAG,CAAC,wBAAwB,MAAM,OAAO,CAAC,QAAQ,GAAG,KAAK,MAAM,CAAC,MAAM,CAAC,GAAG;IACnF,OAAO;AACT;AAEO,MAAM,MAAM;IACjB,KAAK,CAAI,UAAkB,UAA0B,SAAY,UAAU;IAC3E,MAAM,CAAI,UAAkB,MAAW,UAA0B,SAAY,UAAU;YACrF,GAAG,OAAO;YACV,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACA,KAAK,CAAI,UAAkB,MAAW,UAA0B,SAAY,UAAU;YACpF,GAAG,OAAO;YACV,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IACA,QAAQ,CAAI,UAAkB,UAA0B,SAAY,UAAU;YAC5E,GAAG,OAAO;YACV,QAAQ;QACV;AACF"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///Users/zyj/%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%A4%B9/%E6%88%91%E7%9A%84%E4%BB%A3%E7%A0%81/blog/my-blog/web/lib/store.ts"],"sourcesContent":["/**\n * 数据访问层 - 通过 API 调用后端服务\n */\n\nimport { api } from './api'\n\n// 导出类型\nexport interface Post {\n  id: string\n  title: string\n  slug: string\n  content: string\n  excerpt: string\n  coverImage?: string\n  published: boolean\n  createdAt: number\n  updatedAt: number\n  tags?: string[]\n  categoryId?: string\n  category?: Category\n  views: number\n  likes: number\n  commentsCount?: number\n}\n\nexport interface Comment {\n  id: string\n  postId: string\n  author: string\n  content: string\n  createdAt: number\n}\n\nexport interface Category {\n  id: string\n  name: string\n  slug: string\n  description?: string\n  createdAt: number\n}\n\nexport type SortBy = 'latest' | 'popular'\n\n// Store 对象 - 提供 API 接口\nexport const store = {\n  // 文章相关\n  getPostBySlug: async (slug: string) => {\n    try {\n      const post = await api.get<any>(`/api/posts/${slug}`)\n      return convertPost(post)\n    } catch (error) {\n      console.error('Error fetching post by slug:', error)\n      return null\n    }\n  },\n\n  getPostById: async (id: string) => {\n    try {\n      const post = await api.get<any>(`/api/posts/by-id/${id}`)\n      return convertPost(post)\n    } catch (error) {\n      console.error('Error fetching post by id:', error)\n      return null\n    }\n  },\n\n  getPostsByYear: async () => {\n    try {\n      const posts = await api.get<any[]>('/api/posts')\n      const grouped: Record<string, Post[]> = {}\n\n      posts.forEach(post => {\n        const converted = convertPost(post)\n        const year = new Date(converted.createdAt).getFullYear().toString()\n        if (!grouped[year]) {\n          grouped[year] = []\n        }\n        grouped[year].push(converted)\n      })\n\n      return grouped\n    } catch (error) {\n      console.error('Error fetching archive:', error)\n      return {}\n    }\n  },\n\n  getAllPosts: async (sortBy: SortBy = 'latest', categoryId?: string) => {\n    try {\n      const params = new URLSearchParams({\n        sortBy,\n        ...(categoryId && { categoryId })\n      })\n\n      console.log('[Store] Fetching posts with params:', params.toString())\n      const posts = await api.get<any[]>(`/api/posts?${params}`)\n      console.log('[Store] Received posts:', posts.length, 'posts')\n      return posts.map(convertPost)\n    } catch (error) {\n      console.error('[Store] Error fetching posts:', error)\n      return []\n    }\n  },\n\n  getAllPostsAdmin: async () => {\n    try {\n      const posts = await api.get<any[]>('/api/posts/admin')\n      return posts.map(convertPost)\n    } catch (error) {\n      console.error('Error fetching admin posts:', error)\n      return []\n    }\n  },\n\n  // 分类相关\n  getAllCategories: async () => {\n    try {\n      const categories = await api.get<any[]>('/api/categories')\n      return categories.map(convertCategory)\n    } catch (error) {\n      console.error('Error fetching categories:', error)\n      return []\n    }\n  },\n\n  getCategoryById: async (id: string) => {\n    try {\n      const category = await api.get<any>(`/api/categories/${id}`)\n      return convertCategory(category)\n    } catch (error) {\n      console.error('Error fetching category:', error)\n      return null\n    }\n  },\n\n  getPostCountByCategory: async (categoryId: string) => {\n    try {\n      const result = await api.get<{ count: number }>(`/api/categories/${categoryId}/post-count`)\n      return result.count\n    } catch (error) {\n      console.error('Error fetching post count:', error)\n      return 0\n    }\n  },\n\n  // 评论相关\n  getCommentsByPostId: async (postId: string) => {\n    try {\n      const comments = await api.get<any[]>(`/api/comments/post/${postId}`)\n      return comments.map(convertComment)\n    } catch (error) {\n      console.error('Error fetching comments:', error)\n      return []\n    }\n  },\n\n  // 认证相关\n  validateSession: async (token: string) => {\n    try {\n      const user = await api.get<any>('/api/auth/verify', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      })\n      return user\n    } catch (error) {\n      console.error('Error validating session:', error)\n      return null\n    }\n  }\n}\n\n// 辅助函数 - 转换数据库类型到前端类型\nfunction convertPost(post: any): Post {\n  return {\n    id: post.id,\n    title: post.title,\n    slug: post.slug,\n    content: post.content,\n    excerpt: post.excerpt,\n    coverImage: post.coverImage || undefined,\n    published: Boolean(post.published),\n    createdAt: post.createdAt instanceof Date ? post.createdAt.getTime() : post.createdAt,\n    updatedAt: post.updatedAt instanceof Date ? post.updatedAt.getTime() : post.updatedAt,\n    categoryId: post.categoryId || undefined,\n    views: post.views,\n    likes: post.likes,\n    tags: post.tags,\n    category: post.category ? convertCategory(post.category) : undefined,\n    commentsCount: post.commentsCount\n  }\n}\n\nfunction convertCategory(category: any): Category {\n  return {\n    id: category.id,\n    name: category.name,\n    slug: category.slug,\n    description: category.description || undefined,\n    createdAt: category.createdAt instanceof Date ? category.createdAt.getTime() : category.createdAt\n  }\n}\n\nfunction convertComment(comment: any): Comment {\n  return {\n    id: comment.id,\n    postId: comment.postId,\n    author: comment.author,\n    content: comment.content,\n    createdAt: comment.createdAt instanceof Date ? comment.createdAt.getTime() : comment.createdAt\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 239, "column": 0}, "map": {"version":3,"sources":["file:///Users/zyj/%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%A4%B9/%E6%88%91%E7%9A%84%E4%BB%A3%E7%A0%81/blog/my-blog/web/components/post-editor.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const PostEditor = registerClientReference(\n    function() { throw new Error(\"Attempted to call PostEditor() from the server but PostEditor is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/web/components/post-editor.tsx <module evaluation>\",\n    \"PostEditor\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,aAAa,IAAA,wYAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,gEACA","ignoreList":[0]}},
    {"offset": {"line": 253, "column": 0}, "map": {"version":3,"sources":["file:///Users/zyj/%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%A4%B9/%E6%88%91%E7%9A%84%E4%BB%A3%E7%A0%81/blog/my-blog/web/components/post-editor.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const PostEditor = registerClientReference(\n    function() { throw new Error(\"Attempted to call PostEditor() from the server but PostEditor is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/web/components/post-editor.tsx\",\n    \"PostEditor\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,aAAa,IAAA,wYAAuB,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAoO,GACjQ,4CACA","ignoreList":[0]}},
    {"offset": {"line": 267, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 275, "column": 0}, "map": {"version":3,"sources":["file:///Users/zyj/%E4%BB%A3%E7%A0%81%E6%96%87%E4%BB%B6%E5%A4%B9/%E6%88%91%E7%9A%84%E4%BB%A3%E7%A0%81/blog/my-blog/web/app/admin/edit/%5Bid%5D/page.tsx"],"sourcesContent":["/*\n * @Author: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git\n * @Date: 2026-01-27 20:52:26\n * @LastEditors: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git\n * @LastEditTime: 2026-01-27 20:52:34\n * @FilePath: /blog/my-next-app/app/admin/edit/id/page.tsx\n * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\n */\nimport { notFound } from \"next/navigation\"\nimport { store } from \"@/lib/store\"\nimport { PostEditor } from \"@/components/post-editor\"\n\ninterface PageProps {\n  params: Promise<{ id: string }>\n}\n\nexport default async function EditPostPage({ params }: PageProps) {\n  const { id } = await params\n  const post = await store.getPostById(id)\n\n  if (!post) {\n    notFound()\n  }\n\n  return <PostEditor post={post} />\n}\n"],"names":[],"mappings":"AAAA;;;;;;;CAOC;;;;;AACD;AAAA;AACA;AACA;;;;;AAMe,eAAe,aAAa,EAAE,MAAM,EAAa;IAC9D,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IACrB,MAAM,OAAO,MAAM,4HAAK,CAAC,WAAW,CAAC;IAErC,IAAI,CAAC,MAAM;QACT,IAAA,iUAAQ;IACV;IAEA,qBAAO,8WAAC,kJAAU;QAAC,MAAM;;;;;;AAC3B"}}]
}